(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{378:function(e,t,r){"use strict";r.r(t);r(5),r(4),r(2),r(6),r(3),r(7);var o=r(26),n=r(0);r(60),r(1),r(25);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function c(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var d={props:{route:{type:Object,required:!0},showEditCreateRouteModal:{type:Boolean,required:!0},creating:{type:Boolean,required:!1,default:!1}},data:function(){return{serverError:null,isLoading:!1}},computed:{localRoute:function(){return c({},this.route)},formIsValid:function(){return!!(this.localRoute.start_city&&this.localRoute.end_city&&this.localRoute.departure_date&&this.localRoute.completion_date&&this.localRoute.expected_revenue&&this.localRoute.distance&&this.localRoute.transport_type&&this.localRoute.status)}},methods:{cancel:function(){this.$emit("hide")},updateRoute:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,o,n,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.prev=1,e.localRoute.departure_date&&(r=new Date(e.localRoute.departure_date),e.localRoute.departure_date=r.toString()),e.localRoute.completion_date&&(o=new Date(e.localRoute.completion_date),e.localRoute.completion_date=o.toString()),n=e.creating?"/api/v1/routes":"/api/v1/routes/".concat(e.localRoute.id),l=e.creating?"post":"put",t.next=8,e.$axios[l](n,e.localRoute,{headers:{"x-api-key":e.$config.apiKey}});case 8:d=t.sent,e.$emit("hide"),e.$emit("updateRoute",c(c({},d.data),e.localRoute)),e.serverError=null,t.next=19;break;case 14:t.prev=14,t.t0=t.catch(1),console.error("Error updating route:",t.t0),e.serverError=t.t0.message||"Unexpected error occurred",e.localRoute=c({},e.route);case 19:return t.prev=19,e.isLoading=!1,t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[1,14,19,22]])})))()},requiredFieldErrorMessage:function(e){return"".concat(e," is required")}}},f=r(71),component=Object(f.a)(d,(function(){var e=this,t=e._self._c;return t("b-modal",{scopedSlots:e._u([{key:"modal-title",fn:function(){return[e._v("\n    "+e._s(e.route.id?"Edit Route":"Create New Route")+"\n  ")]},proxy:!0},{key:"modal-footer",fn:function(){return[t("b-button",{attrs:{variant:"secondary"},on:{click:e.cancel}},[e._v("Cancel")]),e._v(" "),t("b-button",{attrs:{variant:"primary",disabled:e.isLoading||!e.formIsValid},on:{click:e.updateRoute}},[e._v("Save\n      changes")])]},proxy:!0}]),model:{value:e.showEditCreateRouteModal,callback:function(t){e.showEditCreateRouteModal=t},expression:"showEditCreateRouteModal"}},[e._v(" "),t("b-form",{on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.updateRoute.apply(null,arguments)}}},[t("b-form-group",{attrs:{label:"Start city*",state:!!e.route.start_city&&null,"invalid-feedback":e.requiredFieldErrorMessage("Start city")}},[t("b-form-input",{attrs:{required:""},model:{value:e.route.start_city,callback:function(t){e.$set(e.route,"start_city",t)},expression:"route.start_city"}})],1),e._v(" "),t("b-form-group",{attrs:{label:"End city*",state:!!e.route.end_city&&null,"invalid-feedback":e.requiredFieldErrorMessage("End city")}},[t("b-form-input",{attrs:{required:""},model:{value:e.route.end_city,callback:function(t){e.$set(e.route,"end_city",t)},expression:"route.end_city"}})],1),e._v(" "),t("b-form-group",{attrs:{label:"Departure date*",state:!!e.route.departure_date&&null,"invalid-feedback":e.requiredFieldErrorMessage("Departure date")}},[t("b-form-datepicker",{attrs:{required:""},model:{value:e.route.departure_date,callback:function(t){e.$set(e.route,"departure_date",t)},expression:"route.departure_date"}})],1),e._v(" "),t("b-form-group",{attrs:{label:"Completion date*",state:!!e.route.completion_date&&null,"invalid-feedback":e.requiredFieldErrorMessage("Completion date")}},[t("b-form-datepicker",{attrs:{required:""},model:{value:e.route.completion_date,callback:function(t){e.$set(e.route,"completion_date",t)},expression:"route.completion_date"}})],1),e._v(" "),t("b-form-group",{attrs:{label:"Expected revenue in $*",state:!!e.route.expected_revenue&&null,"invalid-feedback":e.requiredFieldErrorMessage("Expected revenue")}},[t("b-form-input",{attrs:{type:"number",required:""},model:{value:e.route.expected_revenue,callback:function(t){e.$set(e.route,"expected_revenue",t)},expression:"route.expected_revenue"}})],1),e._v(" "),t("b-form-group",{attrs:{label:"Distance in km*",state:!!e.route.distance&&null,"invalid-feedback":e.requiredFieldErrorMessage("Distance")}},[t("b-form-input",{attrs:{type:"number",required:""},model:{value:e.route.distance,callback:function(t){e.$set(e.route,"distance",t)},expression:"route.distance"}})],1),e._v(" "),t("b-form-group",{attrs:{label:"Transport type*",state:!!e.route.transport_type&&null,"invalid-feedback":e.requiredFieldErrorMessage("Transport type")}},[t("b-form-select",{attrs:{options:["cargo","passenger"],required:"",disabled:"ongoing"===e.route.status},model:{value:e.route.transport_type,callback:function(t){e.$set(e.route,"transport_type",t)},expression:"route.transport_type"}}),e._v(" "),"ongoing"===e.route.status?t("span",[e._v("(Cannot be changed for ongoing route)")]):e._e()],1),e._v(" "),t("b-form-group",{attrs:{label:"Status*",state:!!e.route.status&&null,"invalid-feedback":e.requiredFieldErrorMessage("Status")}},[t("b-form-select",{attrs:{options:["ongoing","pending"],required:"",disabled:!e.route.plate_number},model:{value:e.route.status,callback:function(t){e.$set(e.route,"status",t)},expression:"route.status"}}),e._v(" "),e.route.plate_number?e._e():t("span",[e._v("(No assigned transport or transport type was\n        changed or new route)")])],1),e._v(" "),e.serverError?t("div",{staticClass:"alert alert-danger"},[e._v("\n      "+e._s(e.serverError)+"\n    ")]):e._e()],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);