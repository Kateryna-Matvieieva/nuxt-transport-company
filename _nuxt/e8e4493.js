(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{387:function(e,t,o){"use strict";o.r(t);var r=o(0),n=o(26);o(60),o(16),o(14),o(5),o(4),o(2),o(1),o(6),o(3),o(7);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,o)}return t}function l(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={name:"CompleteRouteConfirmModal",props:{routeToComplete:{type:Object,default:null},showModal:{type:Boolean,required:!0}},data:function(){return{completionError:null,completing:!1}},computed:{isFutureRoute:function(){var e,t,o=new Date,r=new Date(null===(e=this.routeToComplete)||void 0===e?void 0:e.departure_date.split("/").reverse().join("-")),n=new Date(null===(t=this.routeToComplete)||void 0===t?void 0:t.completion_date.split("/").reverse().join("-"));return o<r||o<n},message:function(){return this.routeToComplete?"Id(".concat(this.routeToComplete.id,") ").concat(this.routeToComplete.status," route ").concat(this.routeToComplete.start_city,"-").concat(this.routeToComplete.end_city," ").concat(this.routeToComplete.departure_date," - ").concat(this.routeToComplete.completion_date):""}},watch:{isFutureRoute:function(e){this.completionError=e?"The dates of the route are still in the future. Sorry, you cannot complete future routes.":null}},methods:{updateRoute:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isFutureRoute){t.next=3;break}return e.completionError="The dates of the route are still in the future. Sorry, you cannot complete future routes.",t.abrupt("return");case 3:return e.completing=!0,t.prev=4,t.next=7,e.$axios.$patch("/api/v1/routes/".concat(e.routeToComplete.id,"/complete"),{headers:{"x-api-key":e.$config.apiKey}});case 7:e.$emit("complete",l(l({},e.routeToComplete),{},{status:"completed"})),e.completionError=null,t.next=15;break;case 11:t.prev=11,t.t0=t.catch(4),console.error("Error completing route:",t.t0),e.completionError="Failed to complete route. Please try again.";case 15:return t.prev=15,e.completing=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[4,11,15,18]])})))()},cancel:function(){this.$emit("cancel")}}},d=o(71),component=Object(d.a)(m,(function(){var e=this,t=e._self._c;return t("b-modal",{attrs:{centered:"",title:"Confirm Completion"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[t("b-button",{attrs:{variant:"secondary"},on:{click:e.cancel}},[e._v("Cancel")]),e._v(" "),t("b-button",{attrs:{variant:"primary",disabled:e.isFutureRoute||e.completing},on:{click:e.updateRoute}},[e._v("Complete")])]},proxy:!0}]),model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[t("p",[e._v("Are you sure you want to complete the following route?")]),e._v(" "),t("p",[t("strong",[e._v(e._s(e.message))])]),e._v(" "),e.completionError?t("b-alert",{attrs:{show:"",variant:"danger"}},[e._v("\n    "+e._s(e.completionError)+"\n  ")]):e._e()],1)}),[],!1,null,null,null);t.default=component.exports}}]);